{
  "hash": "3c2ea6dd78c3a52b0720e8735addcf1d",
  "result": {
    "markdown": "---\ntitle: \"Take-home_Ex03\"\nauthor: \"Mohamad Hafez Sidek\"\ndate: \"June 9, 2024\"\ndate-modified: \"last-modified\"\nexecute:\n  eval: true\n  echo: true\n  warning: false\n  freeze: true\n  message: false\n---\n\n\n**Installing R Packages**\n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(ggraph,dendextend,tidygraph,jsonlite,dplyr,lubridate,igraph,ggplot2,gridExtra)\n```\n:::\n\n---\n\nLoad JSON data\n\n---\n\n::: {.cell}\n\n```{.r .cell-code}\njson_data <- fromJSON('data/MC3/mc3.json')\n```\n:::\n\n---\n\nExtract the nodes and edges\n\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nnodes <- json_data$nodes\nedges <- json_data$links\n```\n:::\n\n---\n\nData Processing\n\n---\n\n::: {.cell}\n\n```{.r .cell-code}\n# Ensure 'id' columns and edge 'source'/'target' columns are character type\nnodes$id <- as.character(nodes$id)\nedges$source <- as.character(edges$source)\nedges$target <- as.character(edges$target)\n\n# Convert date fields in nodes\nnodes$`founding_date` <- as.Date(nodes$`founding_date`, format = \"%Y-%m-%d\")\nnodes$`_last_edited_date` <- as.Date(nodes$`_last_edited_date`, format = \"%Y-%m-%d\")\nnodes$`_date_added` <- as.Date(nodes$`_date_added`, format = \"%Y-%m-%d\")\n\n# Convert date fields in edges\nedges$`start_date` <- as.Date(edges$`start_date`, format = \"%Y-%m-%d\")\nedges$`end_date` <- as.Date(edges$`end_date`, format = \"%Y-%m-%d\")\n```\n:::\n\n---\n\n\n---\n\n::: {.cell}\n\n:::\n\n***Problem Statement 1:***\nIdentify the network associated with SouthSeafood Express Corp and visualize how this network and competing businesses change as a result of their illegal fishing behavior.\n\n\n::: {.cell}\n\n:::\n\n***Analysis***\n\n\n----\n\n***Problem Statement 2:***\n Which companies benefited from SouthSeafood Express Corp legal troubles? \n\n::: {.cell}\n\n:::\n\n***Analysis***\n\n\n----\n\n***Problem Statement 3:***\nAre there any other suspicious transactions that may be related to illegal fishing?\n\n---\n\nData Processing\n\n\n---\n::: {.cell}\n\n```{.r .cell-code}\n# Convert nodes to a data frame for filtering purposes\nnodes_df <- as.data.frame(nodes)\n\n# Filter the dataset for companies involved in fishing, sea food, and seafood\nfishing_companies <- nodes_df %>%\n  filter(grepl(\"fish|sea food|seafood\", TradeDescription, ignore.case = TRUE))\n\n# Remove rows with missing or non-finite revenue values\nfishing_companies <- fishing_companies %>%\n  filter(!is.na(revenue) & is.finite(revenue))\n\n# Identify top outliers by revenue (95th percentile)\ntop_outliers <- fishing_companies %>%\n  filter(revenue > quantile(revenue, 0.95, na.rm = TRUE))\n\n# Extract the IDs of the top outliers\ntop_outlier_ids <- top_outliers$id\n\n# Convert edges to a data frame for filtering purposes\nedges_df <- as.data.frame(edges)\n\n# Filter edges to include only those related to top outliers\nrelated_edges <- edges_df %>%\n  filter(source %in% top_outlier_ids | target %in% top_outlier_ids)\n\n# Create an edge list for igraph\nedge_list <- as.matrix(related_edges[, c(\"source\", \"target\")])\n```\n:::\n\n----\n\nCreate graph\n\n----\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create graph object\ng <- graph_from_edgelist(edge_list, directed = FALSE)\n\n# Add vertex attributes for revenue and country\nV(g)$revenue <- ifelse(V(g)$name %in% top_outliers$id, top_outliers$revenue[match(V(g)$name, top_outliers$id)], NA)\nV(g)$country <- ifelse(V(g)$name %in% top_outliers$id, top_outliers$country[match(V(g)$name, top_outliers$id)], NA)\n\n# Set node sizes and colors\nV(g)$size <- ifelse(V(g)$name %in% top_outliers$id, 10, 5)  # Increase size for top outliers\nV(g)$color <- ifelse(V(g)$name %in% top_outliers$id, \"skyblue\", \"orange\")  # Different colors for top outliers\nV(g)$shape <- ifelse(V(g)$name %in% top_outliers$id, \"square\", \"circle\")  # Different shapes for top outliers\nE(g)$color <- adjustcolor(\"gray\", alpha.f = 0.5)  # Transparent edges\n\n\n\n# Plot the network graph\nplot(g, vertex.size = V(g)$size, vertex.label.cex = ifelse(V(g)$name %in% top_outliers$id, 0.8, 0.6), \n     vertex.color = V(g)$color, vertex.shape = V(g)$shape,\n     vertex.label = NA, \n     edge.color = E(g)$color, layout = layout_with_fr, \n     main = \"Network Graph of Top Revenue Outliers\")\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex03_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n***Analysis***\nPotential Implications for Suspicious Transactions Related to Illegal Fishing:\nRole of Central Nodes:\n\n***Point 1**\nThe central nodes (skyblue squares) with many connections could be orchestrating significant activities within the network.\nTheir prominent role and high connectivity suggest they might be key players in suspicious transactions related to illegal fishing.\n\n\n***Point 2**\nDense Clusters:The dense clusters around these central nodes indicate high levels of transactional activity.\nThis could be a sign of coordinated efforts to obscure illegal fishing activities through multiple layers of transactions.\nIsolation of Transactions:\n\n***Point 3**\nThe presence of smaller, isolated subgroups suggests attempts to hide certain transactions from the main network.\nThese isolated groups might be used to carry out suspicious activities without drawing attention.\n\n\n***Point 4**\nSystematic Patterns:The repeated patterns of smaller clusters connected to central nodes indicate a systematic approach to transactions.\nThis systematic behavior could be indicative of coordinated efforts to manage and conceal illegal activities related to fishing.\n\n***Conclusion:***\nBased on the analysis of the network graph, there are several visual hints that suggest the possibility of suspicious transactions related to illegal fishing. The prominent role of the central nodes, the dense clusters of transactions, the isolated subgroups, and the systematic patterns all point towards potential coordinated efforts to obscure illegal activities. Further investigation into the nature of these transactions and the entities involved is warranted to confirm these suspicions.\n\n\n",
    "supporting": [
      "Take-home_Ex03_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}